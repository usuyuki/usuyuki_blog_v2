---
import '~/styles/blog/ghostContent.css';
import '~/styles/blog/wordpressContent.css';
import '~/styles/blog/blogCommon.css';
import ArticleLayout from '~/layouts/extends/ArticleLayout.astro';
import { ghostClient } from '~/libs/ghostClient';
import iso8601TimeToDate from '~/libs/iso8601TimeToDate';
const post = await ghostClient.posts
	.read({
		slug: Astro.params.slug,
		include: 'tags'
	})
	.catch((err: any) => {
		console.error(err);
	});

if (post === undefined) {
	return Astro.redirect('/404');
}
post.published_at = iso8601TimeToDate(post.published_at);

const headMeta = {
	title: post.title,
	slug: post.slug,
	// excerptã®åã«åã—ã¦å…¨éƒ¨å‡ºã¦ãã‚‹ã®ã§ã€æ”¹è¡Œã—ã¦150å­—ã§åˆ‡ã‚‹ã€‚
	description: post.excerpt.replace(/\r?\n/g, '').slice(0, 150),
	ogImage: post.feature_image
};
---

<ArticleLayout {...headMeta}>
	<div class="flex">
		<div class="md:w-1/5 hidden md:block">
			<div class="w-12 h-12 rounded-full">{post.published_at.year}å¹´</div>
			<div class="w-12 h-12 rounded-full">{post.published_at.month}æœˆ</div>
			<div class="w-12 h-12 rounded-full">{post.published_at.day}æ—¥</div>
		</div>
		<div class="md:w-4/5">
			<h2 class="text-center mb-2 text-4xl">{post.title}</h2>
			<p class="text-center my-2 text-green"></p>
			{
				post.tags ? (
					<div class="flex justify-center flex-wrap">
						{post.tags.map((tag: any) =>
							tag.visibility === 'public' ? (
								<a
									href={`/tags/${tag.slug}`}
									class="text-center my-2 text-green mx-2"
								>
									ğŸ·{tag.name}
								</a>
							) : (
								''
							)
						)}
					</div>
				) : (
					''
				)
			}
			<p class="text-center mb-12">{post.reading_time} åˆ†ãã‚‰ã„ã§èª­ã‚ã¾ã™ï¼</p>
		</div>
	</div>
	{/* eslint-disable */}
	<article class="blog-content" set:html={post.html} />
	{/* eslint-enable */}
</ArticleLayout>
